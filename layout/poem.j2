{% macro sidebar(item) -%}
<center>
{% if item.type =='image' -%}
{{ image(item) }}
{%- elif item.type == 'youtube' -%}
{{ youtube(item) }}
{%- endif %}
</center>
{%- endmacro %}

{% macro image(item) -%}
<img src="{{ media_url('images/'~item.url) }}" {{ item.attr.to_dict()|xmlattr if item.attr }}>
{%- endmacro %}

{% macro youtube(item) -%}
<iframe width="420" height="315"
        src="http://www.youtube.com/embed/{{ item.id }}"
        frameborder="0" allowfullscreen>
</iframe>
{%- endmacro %}

{% extends "root.j2" -%}
{% block main -%}
<article id="main">
    <pre>
{% filter smartypants -%}
{% block content -%}{%- endblock %}
{%- endfilter %}
    </pre>
</article>
<aside id="sidebar">
{% if meta.cover -%}
<div class="cover">
<center>
{{ image(meta.cover) }}
</center>
</div>
{%- endif %}
{% if meta.related -%}
<div class="related">
<h3>Related</h3>
<ul>
{% for item in meta.related -%}
<li>
{{ sidebar(item) }}
</li>
{%- endfor %}
</ul>
</div>
{%- endif %}
</aside>
<script type="text/javascript">
$("div.related").bind('click', function(ev) {
    $(ev.currentTarget).toggleClass('selected');
    return false;
});
</script>
{%- endblock %}

{% block js -%}
<script src="{{ media_url('js/zepto.min.js') }}" type="text/javascript"></script>
{%- endblock %}